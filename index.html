<!DOCTYPE html>
<html>
<head>
  <title>Alarm System</title>
</head>
<body>
  <h1>Alarm System</h1>
  <label for="sound">Choose an alarm sound:</label>
  <select id="sound">
    <option value="sound1">Sound 1</option>
    <option value="sound2">Sound 2</option>
  </select>
  <button onclick="playTestSound()">Play Test Sound</button>

  <audio id="sound1" src="https://cdn.pixabay.com/download/audio/2022/03/21/audio_7b23a10981.mp3?filename=severe-warning-alarm-98704.mp3" loop></audio>
  <audio id="sound2" src="https://cdn.pixabay.com/download/audio/2022/03/10/audio_b7ca4571b0.mp3?filename=alarm1-32464.mp3" loop></audio>

  <script>
    function playTestSound() {
      var selectedSound = document.getElementById('sound').value;
      var soundElement = document.getElementById(selectedSound);
      soundElement.play();
      setTimeout(function() {
        soundElement.pause();
        soundElement.currentTime = 0;
      }, 3000); // Play for 3 seconds
    }

    function playAlarm() {
      var selectedSound = document.getElementById('sound').value;
      document.getElementById(selectedSound).play();
    }

    function stopAlarm() {
      var sounds = ['sound1', 'sound2'];
      sounds.forEach(function(sound) {
        var soundElement = document.getElementById(sound);
        soundElement.pause();
        soundElement.currentTime = 0;
      });
    }

    async function notifyWebApp() {
      const response = await fetch('https://script.google.com/macros/s/AKfycbzx_HrH5Jg8BLz25TC4038cYqgrvKGjYyvuOrE3M6ZMTN6wk7kyvyWzkjV91v7RkBz0Mg/exec', {
        method: 'POST',
      });
      const result = await response.json();
      if (result.status === 'success') {
        playAlarm();
      }
    }

    // Periodically check for updates from the Google Sheets
    setInterval(async function() {
      const response = await fetch('https://script.google.com/macros/s/AKfycbzx_HrH5Jg8BLz25TC4038cYqgrvKGjYyvuOrE3M6ZMTN6wk7kyvyWzkjV91v7RkBz0Mg/exec', {
        method: 'POST',
      });
      const result = await response.json();
      if (result.status === 'success') {
        playAlarm();
      }
    }, 5000); // Check every 5 seconds
  </script>
</body>
</html>
